
<title>系统配置</title>

<div class="layui-card layadmin-header">
    <div class="layui-breadcrumb" lay-filter="breadcrumb">
        <a lay-href="">主页</a>
        <a><cite>系统配置</cite></a>
    </div>
</div>

<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-header">系统配置</div>
        <div class="layui-card-body" style="padding: 15px;">
            <!--选项卡-->
            <div class="layui-tab">
                <ul class="layui-tab-title">
                    <!--标题-->
                    <li class="layui-this">小程序配置</li>
                    <li>上传配置</li>
                    <li>支付配置</li>
                    <li>功能开关</li>
                    <li>版权配置</li>
                    <li>样式配置</li>
                </ul>
                <div class="layui-tab-content">

                    <!--小程序配置内容-->
                    <div class="layui-tab-item layui-show">

                        <form class="layui-form" action="" onsubmit=" return  false;"  lay-filter="component-form-group-xcx">
                            <div class="layui-form-item">
                                <label class="layui-form-label">小程序名称</label>
                                <div class="layui-input-block">
                                    <input type="text" name="miniapp_name" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">APPID</label>
                                <div class="layui-input-block">
                                    <input type="text" name="appid" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">APPSECRET</label>
                                <div class="layui-input-block">
                                    <input type="text" name="appsecret" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                    <button class="layui-btn" lay-submit lay-filter="LAY-filter-demo-form-xcx">立即提交</button>
                                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                </div>
                            </div>
                        </form>

                    </div>

                    <!--上传配置内容-->
                    <div class="layui-tab-item">
                        <form class="layui-form" action="" onsubmit=" return  false;"   lay-filter="component-form-group-xcx">
                            <div class="layui-form-item">
                                <label class="layui-form-label">请选择上传插件</label>
                                <div class="layui-input-block">
                                    <select id="test" name="open_oss" lay-filter="uploadchajian">
                                        <option value=0>本地上传</option>
                                        <option value=1>阿里云OSS上传</option>
                                        <option value=2>七牛云上传</option>
                                        <option value=3>腾讯云上传</option>
                                    </select>
                                </div>
                            </div>
                            <!--阿里云上传才显示出来-->
                            <div id="aliyun_oss">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">仓库名称</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="bucket" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">accesskeyid</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="access_key_id" required  placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">accesssecret</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="access_key_secret" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">上传根目录</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="base_dir" required  placeholder="" autocomplete="off" class="layui-input">
                                        <blockquote class="layui-elem-quote">代表仓库顶层目录名称,请以英文字母命名,前后不用加'/',例如：mingpian_image</blockquote>

                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">自定义域名</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="zidinyi_yuming" required  placeholder="" autocomplete="off" class="layui-input">
                                        <blockquote class="layui-elem-quote">自定义域名前面要加https://,结尾不用加'/'</blockquote>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">endpoint</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="endpoint" required   placeholder="" autocomplete="off" class="layui-input">
                                        <blockquote class="layui-elem-quote">endpoint前面要加https://,结尾不用加'/'</blockquote>
                                    </div>
                                </div>
                                <!--规则配置-->
                                <!--<div class="layui-form-item">-->
                                    <!--<label class="layui-form-label">规则配置</label>-->
                                    <!--<div class="layui-input-block">-->
                                        <!--<textarea name="aliyun_rules" disabled="disabled" placeholder="请输入内容" class="layui-textarea"></textarea>-->
                                    <!--</div>-->
                                <!--</div>-->

                            </div>

                            <!--七牛云上传才显示出来-->
                            <div id="qiniuyun">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">AK</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="accesskey" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">SK</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="secretkey" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">仓库名称</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="qiniu_bucket" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>

                                <div class="layui-form-item">
                                    <label class="layui-form-label">自定义域名</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="qiniu_yuming" required   placeholder="" autocomplete="off" class="layui-input">
                                        <blockquote class="layui-elem-quote">域名前面要加http://</blockquote>
                                    </div>
                                </div>
                                <!--<div class="layui-form-item">-->
                                    <!--<label class="layui-form-label">规则配置</label>-->
                                    <!--<div class="layui-input-block">-->
                                        <!--<textarea disabled="disabled" name="qiniu_rules" placeholder="请输入内容" class="layui-textarea"></textarea>-->
                                    <!--</div>-->
                                <!--</div>-->
                            </div>

                            <!--腾讯云上传才显示出来-->
                            <div id="tenxunyun">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">APPID</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="tenxunyun_appid" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">SECRETID</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="tenxunyun_secretid" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">SECRETKEY</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="tenxunyun_secretkey" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">仓库名称</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="tenxunyun_bucket" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">仓库地域</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="tenxunyun_region" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">仓库域名</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="tenxunyun_yuming" required   placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                    <button class="layui-btn" lay-submit lay-filter="LAY-filter-demo-form-xcx">立即提交</button>
                                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!--支付配置-->
                    <div class="layui-tab-item">

                        <form class="layui-form" action="" onsubmit=" return  false;"  lay-filter="component-form-group-xcx">
                            <div class="layui-form-item">
                                <label class="layui-form-label">商户号</label>
                                <div class="layui-input-block">
                                    <input type="text" name="mini_mid" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">支付秘钥</label>
                                <div class="layui-input-block">
                                    <input type="text" name="mini_apicode" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">是否开启推客功能</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="open_partner" value='1' title="开启">
                                    <input type="radio" name="open_partner" value='0' title="关闭">
                                    <blockquote class="layui-elem-quote">关闭该功能,个人中心不显示入口，且不生成下线。</blockquote>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">提现方式</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="withdrawal_type" value='0' title="手动提现">
                                    <input type="radio" name="withdrawal_type" value='1' title="自动提现">
                                    <blockquote class="layui-elem-quote">手动提现:用户提交请求,通过微信号线下转账
                                        自动提现:使用条件:1、商户号（或同主体其他非服务商商户号）已入驻90日 2、商户号（或同主体其他非服务商商户号）有30天连续正常交易 3、 登录微信支付商户平台-产品中心，开通企业付款。</blockquote>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">最低提现金额</label>
                                <div class="layui-input-block">
                                    <input type="number" name="withdrawal_limit" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                    <blockquote class="layui-elem-quote">单位(元) ,填入0代表不限制 </blockquote>
                                </div>
                            </div>

                            <!--提现证书 命名正确提示-->
                            <div class="layui-form-item">
                                <label class="layui-form-label">提现证书cert</label>
                                <div class="layui-upload">
                                    <div class="layui-input-block">
                                        <button type="button" class="layui-btn layui-btn-info" id="test-upload-cert"><i class="layui-icon"></i>上传证书文件cert</button>
                                        <p id="test-upload-demoText-cert"></p>
                                        <blockquote class="layui-elem-quote">上传文件命名规则：“apiclient_cert.pem”</blockquote>
                                    </div>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">提现证书key</label>
                                <div class="layui-upload">
                                    <div class="layui-input-block">
                                        <button type="button" class="layui-btn layui-btn-info" id="test-upload-key"><i class="layui-icon"></i>上传证书文件key</button>
                                        <p id="test-upload-demoText-key"></p>
                                        <blockquote class="layui-elem-quote">上传文件命名规则：“apiclient_key.pem”</blockquote>
                                    </div>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                    <button class="layui-btn" lay-submit lay-filter="LAY-filter-demo-form-xcx">立即提交</button>
                                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!--功能开关-->
                    <div class="layui-tab-item">

                        <form class="layui-form" action="" onsubmit=" return  false;"  lay-filter="component-form-group-xcx">
                            <!--<div class="layui-form-item">-->
                                <!--<label class="layui-form-label">Debug模式开关</label>-->
                                <!--<div class="layui-input-block">-->
                                    <!--<input type="radio" name="debug_switch" value='1' title="开启">-->
                                    <!--<input type="radio" name="debug_switch" value='0' title="关闭">-->
                                    <!--<blockquote class="layui-elem-quote">开启之后，前端会显示具体的后台配置错误信息。</blockquote>-->
                                <!--</div>-->
                            <!--</div>-->

                            <div class="layui-form-item">
                                <label class="layui-form-label">IOS虚拟支付</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="ios_pay_switch" value='1' title="开启">
                                    <input type="radio" name="ios_pay_switch" value='0' title="关闭">
                                    <blockquote class="layui-elem-quote">开启之后，前端IOS系统用户会显示会员等支付功能。建议在提交微信审核时关闭。</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">Android虚拟支付</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="android_pay_switch" value='1' title="开启">
                                    <input type="radio" name="android_pay_switch" value='0' title="关闭">
                                    <blockquote class="layui-elem-quote">开启之后，前端Android系统用户会显示会员等支付功能。建议在提交微信审核时关闭。</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">审核模式</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="god_mode" value='1' title="开启">
                                    <input type="radio" name="god_mode" value='0' title="关闭">
                                    <blockquote class="layui-elem-quote">开启之后，创建公司只有由管理员在后台审核通过并且设置到期时间, 关闭了此开关任何人都能创建公司无需后台审核, 但是雷达需要付费开启, 付费设置在套餐设置处设置</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">试用天数</label>
                                <div class="layui-input-block">
                                    <input type="number" min="1" max="90" value="1" name="manage_trial_days" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                    <blockquote class="layui-elem-quote">仅在审核模式开启后有效, 当审核模式开启时, 审核通过公司但不设置公司的到期时间就会自动选择试用, 在试用天数内该公司可以正常使用功能且不会占据公司名额。取值范围为1-90</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">试用人数</label>
                                <div class="layui-input-block">
                                    <input type="number" min="1" max="10" value="1" name="manage_trial_people" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                    <blockquote class="layui-elem-quote">仅在审核模式开启后有效, 当审核模式开启时, 审核通过公司但不设置公司的到期时间就会自动选择试用, 在试用天数内该公司可以正常使用功能且不会占据公司名额。取值范围为1-10, 试用人数为公司试用期间可以邀请的企业人员的数量。</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                    <button class="layui-btn" lay-submit lay-filter="LAY-filter-demo-form-xcx">立即提交</button>
                                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!--版权配置-->
                    <div class="layui-tab-item">

                        <form class="layui-form" action="" onsubmit=" return  false;"  lay-filter="component-form-group-xcx">
                            <div class="layui-form-item">
                                <label class="layui-form-label">版权开关</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="copyright_switch" value='1' title="开启">
                                    <input type="radio" name="copyright_switch" value='0' title="关闭">
                                    <blockquote class="layui-elem-quote">开启之后，前端会显示具体的版权信息。</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">版权图片</label>
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn" id="btn-upload-copyright-img">上传图片</button>
                                    <div class="layui-upload-list del-image"  id="div-upload-copyright-img"><ul></ul></div>

                                    <blockquote style="margin-left: 110px" class="layui-elem-quote" style="margin-top: 10px;">
                                        底部版权展示图片, 尺寸: 200 * 高度不限
                                    </blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">版权文字</label>
                                <div class="layui-input-block">
                                    <input type="text" name="copyright_text" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">展示方式</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="copyright_show" value='1' title="仅显示图片">
                                    <input type="radio" name="copyright_show" value='2' title="仅显示文字">
                                    <input type="radio" name="copyright_show" value='3' title="图片加文字">
                                    <blockquote class="layui-elem-quote">开启版权时, 版权的展示形式</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">点击内容</label>
                                <div class="layui-input-block">
                                    <input type="text" name="copyright_target" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                    <blockquote class="layui-elem-quote">对应下方点击效果, 可填手机号, 需要跳转的小程序appid, 跳转链接, 跳转链接必须以https://开头并且配置了业务域名</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">点击效果</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="copyright_jump" value='1' title="拨打手机号">
                                    <input type="radio" name="copyright_jump" value='2' title="跳转小程序">
                                    <input type="radio" name="copyright_jump" value='3' title="跳转链接">
                                    <blockquote class="layui-elem-quote">当用户点击版权时, 执行的具体操作</blockquote>
                                </div>
                            </div>


                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                    <button class="layui-btn" lay-submit lay-filter="LAY-filter-demo-form-xcx">立即提交</button>
                                    <!--<button type="reset" class="layui-btn layui-btn-primary">重置</button>-->
                                </div>
                            </div>
                        </form>
                    </div>

                    <!--样式配置-->
                    <div class="layui-tab-item">

                        <form class="layui-form" action="" onsubmit=" return  false;"  lay-filter="component-form-group-xcx">

                            <div class="layui-form-item">
                                <label class="layui-form-label">默认用户名</label>
                                <div class="layui-input-block">
                                    <input type="text" name="default_username" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                    <blockquote class="layui-elem-quote">当用户没有同意授权显示的名称前缀，例如填入:游客_(后面自动会跟上用户ID)</blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">默认用户头像</label>
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn" id="btn-upload-default_user">上传图片</button>
                                    <div class="layui-upload-list del-image"  id="div-upload-default_user"><ul></ul></div>
                                    <blockquote style="margin-left: 110px" class="layui-elem-quote" style="margin-top: 10px;">
                                        当用户没有同意授权显示的头像，尺寸: 500 * 500
                                    </blockquote>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">默认LOGO</label>
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn" id="btn-upload-default_logo">上传图片</button>
                                    <div class="layui-upload-list del-image"  id="div-upload-default_logo"><ul></ul></div>
                                </div>

                                <blockquote style="margin-left: 110px" class="layui-elem-quote" style="margin-top: 10px;">
                                    默认LOGO图片, 尺寸: 104 * 104
                                </blockquote>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">默认商品图</label>
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn" id="btn-upload-default_good">上传图片</button>
                                    <div class="layui-upload-list del-image"  id="div-upload-default_good"><ul></ul></div>
                                </div>

                                <blockquote style="margin-left: 110px" class="layui-elem-quote" style="margin-top: 10px;">
                                    默认LOGO图片, 尺寸: 750 * 400
                                </blockquote>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">默认动态背景图</label>
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn" id="btn-upload-default_timeline_bg">上传图片</button>
                                    <div class="layui-upload-list del-image"  id="div-upload-default_timeline_bg"><ul></ul></div>
                                </div>

                                <blockquote style="margin-left: 110px" class="layui-elem-quote" style="margin-top: 10px;">
                                    默认动态背景图, 尺寸: 750 * 350
                                </blockquote>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">人脉圈入口图片</label>
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn" id="btn-upload-default_contacts_entry">上传图片</button>
                                    <div class="layui-upload-list del-image"  id="div-upload-default_contacts_entry"><ul></ul></div>
                                </div>

                                <blockquote style="margin-left: 110px" class="layui-elem-quote" style="margin-top: 10px;">
                                    默认人脉圈入口图片, 尺寸: 750 * 400
                                </blockquote>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">更多分类图标</label>
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn" id="btn-upload-default_category">上传图标</button>
                                    <div class="layui-upload-list del-image"  id="div-upload-default_category"><ul></ul></div>
                                </div>

                                <blockquote style="margin-left: 110px" class="layui-elem-quote" style="margin-top: 10px;">
                                    默认更多分类图标, 尺寸:96 * 96
                                </blockquote>
                            </div>


                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                    <button class="layui-btn" lay-submit lay-filter="LAY-filter-demo-form-xcx">立即提交</button>
                                    <!--<button type="reset" class="layui-btn layui-btn-primary">重置</button>-->
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    layui.use(['layer', 'form'], function(){
        //定义表单
        var $ = layui.$
            ,admin = layui.admin
            ,element = layui.element
            ,layer = layui.layer
            ,form = layui.form;

        layer.load();


        //隐藏
        $('#aliyun_oss').hide();
        $('#qiniuyun').hide();
        $('#tenxunyun').hide();

        //富文本编辑器 初始化
        var  layedit;
        var  index;

        layui.use('layedit', function(){
            layedit = layui.layedit;
            var url=config.url+'base_admin/upload?type=picture';//图片上传路径
            index=layedit.build('demo',{
                height:600,
                uploadImage:{url: url, type: 'post'},
            }); //建立编辑器
        });

        $('.del-image').on('click','.layui-icon', function () {
            $(this).parents('dd').remove();
        });

        //查询配置
        admin.req({
            type:'POST',
            url: config.url+'manage_base/config/index',//数据接口
            done:function(res){
                if(res.data){
                    console.log('res.data', res.data);
                    layer.closeAll();
                    //预设元素
                    form.val("component-form-group-xcx", {
                        "default_username": res.data.default_username,// "name": "value"
                        "miniapp_name": res.data.miniapp_name,// "name": "value"
                        "appid": res.data.appid,// "name": "value"
                        "appsecret": res.data.appsecret,// "name": "value"
                        "open_oss": res.data.open_oss,// "name": "value"
                        "bucket": res.data.bucket,// "name": "value"
                        "access_key_id": res.data.access_key_id,// "name": "value"
                        "access_key_secret": res.data.access_key_secret,// "name": "value"
                        "base_dir": res.data.base_dir,// "name": "value"
                        "zidinyi_yuming": res.data.zidinyi_yuming,// "name": "value"
                        "endpoint": res.data.endpoint,// "name": "value"
                        "mini_mid": res.data.mini_mid,// "name": "value"
                        "mini_apicode": res.data.mini_apicode,// "name": "value"
                        "tech_support": res.data.tech_support,// "name": "value"
                        "index_text": res.data.index_text,// "name": "value"
                        "debug_switch": res.data.debug_switch,// "name": "value"
                        "ios_pay_switch": res.data.ios_pay_switch,// "name": "value"
                        "android_pay_switch": res.data.android_pay_switch,// "name": "value"
                        "accesskey": res.data.accesskey,// "name": "value"
                        "secretkey": res.data.secretkey,// "name": "value"
                        "qiniu_bucket": res.data.qiniu_bucket,// "name": "value"
                        "qiniu_yuming": res.data.qiniu_yuming,// "name": "value"
                        "open_partner": res.data.open_partner,// "name": "value"
                        "partner_poster": res.data.partner_poster,// "name": "value"
                        "withdrawal_type": res.data.withdrawal_type,// "name": "value"
                        "withdrawal_limit": res.data.withdrawal_limit,// "name": "value"
                        "shibie_type": res.data.shibie_type,// "name": "value"
                        "tenxunyun_appid": res.data.tenxunyun_appid,// "name": "value"
                        "tenxunyun_secretid": res.data.tenxunyun_secretid,// "name": "value"
                        "tenxunyun_secretkey": res.data.tenxunyun_secretkey,// "name": "value"
                        "tenxunyun_bucket": res.data.tenxunyun_bucket,// "name": "value"
                        "tenxunyun_region": res.data.tenxunyun_region,// "name": "value"
                        "tenxunyun_yuming": res.data.tenxunyun_yuming,// "name": "value"
                        "apiclient_cert": res.data.apiclient_cert,// "name": "value"
                        "apiclient_key": res.data.copyright_switch,// "name": "value"
                        "copyright_switch": res.data.copyright_switch,// "name": "value"
                        "copyright_img": res.data.copyright_img,// "name": "value"
                        "copyright_text": res.data.copyright_text,// "name": "value"
                        "copyright_show": res.data.copyright_show,// "name": "value"
                        "copyright_target": res.data.copyright_target,// "name": "value"
                        "copyright_jump": res.data.copyright_jump,// "name": "value"
                        "god_mode": res.data.god_mode,// "name": "value"
                        "manage_trial_days": res.data.manage_trial_days ? res.data.manage_trial_days : 1,// "name": "value"
                        "manage_trial_people": res.data.manage_trial_people ? res.data.manage_trial_people : 1,// "name": "value"
                    });

                    if(res.data.copyright_img && res.data.copyright_img.length > 0){
                        var str = '<dd><i class="layui-icon" >&#x1007;</i> <img  width="100px" src="'+res.data.copyright_img[0].path+'">' +
                            '<p id=""></p>' +
                            '<input type="hidden" name="copyright_img" value="'+res.data.copyright_img[0].id+'"></dd>';
                        $('#div-upload-copyright-img ul').append(str);
                        /*$('#test-upload-normal-img-avatar').attr('src', res.data.person_avatar);*/
                    }

                    /*默认用户头像*/
                    if(res.data.default_user && res.data.default_user.length > 0){
                        var str = '<dd><i class="layui-icon" >&#x1007;</i> <img  width="100px" src="'+res.data.default_user[0].path+'">' +
                                '<p id=""></p>' +
                                '<input type="hidden" name="default_user" value="'+res.data.default_user[0].id+'"></dd>';
                        $('#div-upload-default_user ul').append(str);
                        /*$('#test-upload-normal-img-avatar').attr('src', res.data.person_avatar);*/
                    }

                    /*默认logo*/
                    if(res.data.default_logo && res.data.default_logo.length > 0){
                        var str = '<dd><i class="layui-icon" >&#x1007;</i> <img  width="100px" src="'+res.data.default_logo[0].path+'">' +
                                '<p id=""></p>' +
                                '<input type="hidden" name="default_logo" value="'+res.data.default_logo[0].id+'"></dd>';
                        $('#div-upload-default_logo ul').append(str);
                        /*$('#test-upload-normal-img-avatar').attr('src', res.data.person_avatar);*/
                    }

                    /*默认商品图片*/
                    if(res.data.default_good && res.data.default_good.length > 0){
                        var str = '<dd><i class="layui-icon" >&#x1007;</i> <img  width="100px" src="'+res.data.default_good[0].path+'">' +
                                '<p id=""></p>' +
                                '<input type="hidden" name="default_good" value="'+res.data.default_good[0].id+'"></dd>';
                        $('#div-upload-default_good ul').append(str);
                        /*$('#test-upload-normal-img-avatar').attr('src', res.data.person_avatar);*/
                    }

                    /*默认商城背景图*/
                    if(res.data.default_timeline_bg && res.data.default_timeline_bg.length > 0){
                        var str = '<dd><i class="layui-icon" >&#x1007;</i> <img  width="100px" src="'+res.data.default_timeline_bg[0].path+'">' +
                                '<p id=""></p>' +
                                '<input type="hidden" name="default_timeline_bg" value="'+res.data.default_timeline_bg[0].id+'"></dd>';
                        $('#div-upload-default_timeline_bg ul').append(str);
                        /*$('#test-upload-normal-img-avatar').attr('src', res.data.person_avatar);*/
                    }

                    /*默认人脉圈入口图片*/
                    if(res.data.contacts_entry && res.data.contacts_entry.length > 0){
                        var str = '<dd><i class="layui-icon" >&#x1007;</i> <img  width="100px" src="'+res.data.contacts_entry[0].path+'">' +
                                '<p id=""></p>' +
                                '<input type="hidden" name="contacts_entry" value="'+res.data.contacts_entry[0].id+'"></dd>';
                        $('#div-upload-default_contacts_entry ul').append(str);
                        /*$('#test-upload-normal-img-avatar').attr('src', res.data.person_avatar);*/
                    }

                    /*分类更多图标*/
                    if(res.data.category_more && res.data.category_more.length > 0){
                        var str = '<dd><i class="layui-icon" >&#x1007;</i> <img  width="100px" src="'+res.data.category_more[0].path+'">' +
                                '<p id=""></p>' +
                                '<input type="hidden" name="category_more" value="'+res.data.category_more[0].id+'"></dd>';
                        $('#div-upload-default_category ul').append(str);
                        /*$('#test-upload-normal-img-avatar').attr('src', res.data.person_avatar);*/
                    }

                    if(res.data.partner_poster_path){
                        $('#test-upload-normal-img-poster').attr('src', res.data.partner_poster_path);
                    }

                    if(res.data.open_oss==1){
                        $('#aliyun_oss').show();
                    }
                    if(res.data.open_oss==2){
                        $('#qiniuyun').show();
                    }
                    if(res.data.open_oss==3){
                        $('#tenxunyun').show();
                    }
                    if(res.data.apiclient_cert==true){
                        $('#test-upload-demoText-cert').html('已上传');
                    }
                    if(res.data.apiclient_key==true){
                        $('#test-upload-demoText-key').html('已上传');
                    }
                    //富文本编辑框内容的回显(这一句会报错  在此之前写代码)

                }else{//没有数据的时候默认值
                    form.val("component-form-group-xcx", {
                        "open_oss": 0,
                        "debug_switch": 1,
                        "ios_pay_switch": 1,
                        "android_pay_switch": 1,
                        "open_partner": 1,
                        "withdrawal_type": 0,
                        "shibie_type": 0,
                        "qiye_switch": 1
                    });
                }
            }
        });
        //选择下拉框 联动
        form.on('select(uploadchajian)', function(data){
            console.log(data.elem); //得到select原始DOM对象
            console.log(data.value); //得到被选中的值
            console.log(data.othis); //得到美化后的DOM对象
            if(data.value==1){//选择阿里云
                $('#aliyun_oss').show();
                $('#qiniuyun').hide();
                $('#tenxunyun').hide();
            }else if(data.value==2){
                $('#aliyun_oss').hide();
                $('#tenxunyun').hide();
                $('#qiniuyun').show();
            }else if(data.value==3){
                $('#aliyun_oss').hide();
                $('#qiniuyun').hide();
                $('#tenxunyun').show();
            } else if(data.value==0){
                $('#aliyun_oss').hide();
                $('#qiniuyun').hide();
            }
        });

        /* 自定义验证规则 */
        form.verify({
            content: function(value) {//验证富文本编辑器
                return layedit.sync(index);
            },
            lengthrequire:function(value) {//验证appid
                if(value.length !=18){
                    return '长度必须为18位';
                }
            },
            lengthrequire2:function(value) {//验证appsecret
                if(value.length !=32){
                    return '长度必须为32位';
                }
            },
            lengthrequire3:[/^\d{10}$/, '商户号需要必须是10为的数字']
        });

        //监听提交
        form.on('submit', function(data){
            //发送请求
            layer.load();
            admin.req({
                type:'POST',
                url: config.url+'manage_base/config/edit'//数据接口
                ,data:data.field,
                done:function(res){
                    layer.closeAll();
                    layer.msg('修改成功', {
                        offset: '15px'
                        ,icon: 1
                        ,time: 1000
                    }, function(){
                        window.location.href =config.html_url+'manage_base/config/index';
                    });
                }
            });
            return  false;
        });
    });

    /*上传图片*/
    layui.use(['admin', 'upload'], function(){
        var $ = layui.jquery
            ,upload = layui.upload;


        //证书文件上传
        upload.render({ //允许上传的文件后缀
            elem: '#test-upload-cert'
            // ,url: config.url+'multi_config/uploadCert'//上传地址
            ,url: config.url+'manage_base/base_admin/uploadCert'//上传地址
            ,data:{"type":"cert","file_name":'apiclient_cert.pem'}
            ,accept: 'file' //普通文件
            ,exts: 'pem' //只允许的文件后缀
            ,done: function(res){
                if(res.data.code==0){
                    layer.msg('上传成功', {
                        offset: '15px'
                        ,icon: 1
                        ,time: 1000
                    }, function(){
                        $('#test-upload-demoText-cert').html('已上传');
                    });
                }else{
                    layer.msg(res.data.msg);
                }
            }
        });

        //证书文件上传
        upload.render({ //允许上传的文件后缀
            elem: '#test-upload-key'
            ,url: config.url+'manage_base/base_admin/uploadCert'//上传地址
            ,data:{"type":"cert","file_name":"apiclient_key.pem"}
            ,accept: 'file' //普通文件
            ,exts: 'pem' //只允许的文件后缀
            ,done: function(res){
                ////返回的 是否上传成功   要检测文件
                if(res.data.code==0){
                    layer.msg('上传成功', {
                        offset: '15px'
                        ,icon: 1
                        ,time: 1000
                    }, function(){
                        $('#test-upload-demoText-key').html('已上传');
                    });
                }else{
                    layer.msg(res.data.msg);
                }
            }
        });

        //版权图片
        upload.render({
            elem: '#btn-upload-copyright-img'
            ,url: config.url + 'manage_base/base_admin/upload'//上传地址
            ,data:{"type":"picture"}
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                /* obj.preview(function(index, file, result){
                     $('#test-upload-normal-img-avatar').attr('src', result); //图片链接（base64）
                 });*/
                layer.load(0, {
                    offset: 'auto'
                });
            }
            ,done: function(res){
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $('#div-upload-copyright-img ul').empty();
                var str = '<dd><i class="layui-icon">&#x1007;</i> <img  width="100px" src="'+res.data.src+'"> ' +
                    '<p id="p-upload-cover"></p>' +
                    '<input type="hidden" name="copyright_img" value="'+res.data.id+'" id="cover"></dd>';
                $('#div-upload-copyright-img ul').append(str);
                layer.closeAll();
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#p-upload-cover');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                    uploadInst.upload();
                });
            }
        });

        //默认用户头像
        upload.render({
            elem: '#btn-upload-default_user'
            ,url: config.url + 'manage_base/base_admin/upload'//上传地址
            ,data:{"type":"picture"}
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                /* obj.preview(function(index, file, result){
                 $('#test-upload-normal-img-avatar').attr('src', result); //图片链接（base64）
                 });*/
                layer.load(0, {
                    offset: 'auto'
                });
            }
            ,done: function(res){
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $('#div-upload-default_user ul').empty();
                var str = '<dd><i class="layui-icon">&#x1007;</i> <img  width="100px" src="'+res.data.src+'"> ' +
                        '<p id="p-upload-cover"></p>' +
                        '<input type="hidden" name="default_user" value="'+res.data.id+'" id="cover"></dd>';
                $('#div-upload-default_user ul').append(str);
                layer.closeAll();
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#p-upload-cover');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                    uploadInst.upload();
                });
            }
        });

        //默认 LOGO
        upload.render({
            elem: '#btn-upload-default_logo'
            ,url: config.url + 'manage_base/base_admin/upload'//上传地址
            ,data:{"type":"picture"}
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                /* obj.preview(function(index, file, result){
                 $('#test-upload-normal-img-avatar').attr('src', result); //图片链接（base64）
                 });*/
                layer.load(0, {
                    offset: 'auto'
                });
            }
            ,done: function(res){
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $('#div-upload-default_logo ul').empty();
                var str = '<dd><i class="layui-icon">&#x1007;</i> <img  width="100px" src="'+res.data.src+'"> ' +
                        '<p id="p-upload-cover"></p>' +
                        '<input type="hidden" name="default_logo" value="'+res.data.id+'" id="cover"></dd>';
                $('#div-upload-default_logo ul').append(str);
                layer.closeAll();
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#p-upload-cover');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                    uploadInst.upload();
                });
            }
        });

        //默认商品图片
        upload.render({
            elem: '#btn-upload-default_good'
            ,url: config.url + 'manage_base/base_admin/upload'//上传地址
            ,data:{"type":"picture"}
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                /* obj.preview(function(index, file, result){
                 $('#test-upload-normal-img-avatar').attr('src', result); //图片链接（base64）
                 });*/
                layer.load(0, {
                    offset: 'auto'
                });
            }
            ,done: function(res){
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $('#div-upload-default_good ul').empty();
                var str = '<dd><i class="layui-icon">&#x1007;</i> <img  width="100px" src="'+res.data.src+'"> ' +
                        '<p id="p-upload-cover"></p>' +
                        '<input type="hidden" name="default_good" value="'+res.data.id+'" id="cover"></dd>';
                $('#div-upload-default_good ul').append(str);
                layer.closeAll();
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#p-upload-cover');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                    uploadInst.upload();
                });
            }
        });

        //默认商城背景图
        upload.render({
            elem: '#btn-upload-default_timeline_bg'
            ,url: config.url + 'manage_base/base_admin/upload'//上传地址
            ,data:{"type":"picture"}
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                /* obj.preview(function(index, file, result){
                 $('#test-upload-normal-img-avatar').attr('src', result); //图片链接（base64）
                 });*/
                layer.load(0, {
                    offset: 'auto'
                });
            }
            ,done: function(res){
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $('#div-upload-default_timeline_bg ul').empty();
                var str = '<dd><i class="layui-icon">&#x1007;</i> <img  width="100px" src="'+res.data.src+'"> ' +
                        '<p id="p-upload-cover"></p>' +
                        '<input type="hidden" name="default_timeline_bg" value="'+res.data.id+'" id="default_timeline_bg"></dd>';
                $('#div-upload-default_timeline_bg ul').append(str);
                layer.closeAll();
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#p-upload-cover');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                    uploadInst.upload();
                });
            }
        });


        //默认人脉圈入口图片
        upload.render({
            elem: '#btn-upload-default_contacts_entry'
            ,url: config.url + 'manage_base/base_admin/upload'//上传地址
            ,data:{"type":"picture"}
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                /* obj.preview(function(index, file, result){
                 $('#test-upload-normal-img-avatar').attr('src', result); //图片链接（base64）
                 });*/
                layer.load(0, {
                    offset: 'auto'
                });
            }
            ,done: function(res){
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $('#div-upload-default_contacts_entry ul').empty();
                var str = '<dd><i class="layui-icon">&#x1007;</i> <img  width="100px" src="'+res.data.src+'"> ' +
                        '<p id="p-upload-cover"></p>' +
                        '<input type="hidden" name="contacts_entry" value="'+res.data.id+'" id="contacts_entry"></dd>';
                $('#div-upload-default_contacts_entry ul').append(str);
                layer.closeAll();
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#p-upload-cover');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                    uploadInst.upload();
                });
            }
        });



        //分类更多图标
        upload.render({
            elem: '#btn-upload-default_category'
            ,url: config.url + 'manage_base/base_admin/upload'//上传地址
            ,data:{"type":"picture"}
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                /* obj.preview(function(index, file, result){
                 $('#test-upload-normal-img-avatar').attr('src', result); //图片链接（base64）
                 });*/
                layer.load(0, {
                    offset: 'auto'
                });
            }
            ,done: function(res){
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $('#div-upload-default_category ul').empty();
                var str = '<dd><i class="layui-icon">&#x1007;</i> <img  width="100px" src="'+res.data.src+'"> ' +
                        '<p id="p-upload-cover"></p>' +
                        '<input type="hidden" name="category_more" value="'+res.data.id+'" id="category_more"></dd>';
                $('#div-upload-default_category ul').append(str);
                layer.closeAll();
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#p-upload-cover');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                    uploadInst.upload();
                });
            }
        });
    });
</script>